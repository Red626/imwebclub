webpackJsonp([1],[function(t,e,n){t.exports=n(20)},,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n(21),n(24),n(26),n(28),n(30),n(31)},function(t,e){},,,function(t,e){},,function(t,e){},,function(t,e){},,function(t,e){},function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}var i=n(32),a=o(i);n(33),n(34),function(){var t=window.imweb=window.imweb||{},e=new Remarkable;e.set({html:!1,xhtmlOut:!1,breaks:!1,linkify:!0,typographer:!0}),e.renderer.rules.fence=function(t,e){var n=t[e],o=n.params&&"language-"+n.params||"";return o=_.escape(o),'<pre class="prettyprint '+o+'"><code>'+_.escape(n.content)+"</code></pre>"},e.renderer.rules.code=function(t,e){var n=t[e],o=n.params&&"language-"+n.params||"";return o=_.escape(o),n.block?'<pre class="prettyprint '+o+'"><code>'+_.escape(t[e].content)+"</code></pre>":"<code>"+_.escape(t[e].content)+"</code>"},t.md=e,t.markdown=function(t){return e.render(t||"")},_.templateSettings=_.extend(_.templateSettings||{},a.templateSettings),t.template=function(n,o){return _.template(document.getElementById(n).innerHTML)(_.extend({_:_,csrf:t._csrf||"",markdown:t.markdown,md:e,user:t.user||null,isLogin:!!t.user,isAdmin:t.user&&t.user.is_admin},o||{}))},t.template.compile=function(t){return _.template(t)},t.userUtils=t.userUtils||{},$.extend(t.userUtils,{isLogin:function(){return t.user&&t.user.loginname},checkLogin:function(){var t=this.isLogin();return t||alert("请先登录!"),t}}),t.ajax=t.ajax||{},$.extend(t.ajax,{post:function(e,n){return n=n||{},n.data=$.extend({_csrf:t._csrf},n.data||{}),$.ajax(e,$.extend({method:"post"},n))},get:function(t,e){return e=e||{},$.ajax(t,$.extend({method:"get"},e))},fail:function(t){403===t.status?alert("请先登录，登陆后即可点赞。"):t.status>=500?alert("系统异常，请稍候重试。"):alert("系统错误，请稍候重试。")}}),$(function(){$("form").submit(function(){$(this).find("*[name=_csrf]").length||$('<input type="hidden" name="_csrf" />').val(t._csrf).appendTo($(this))})})}(),$(function(){$(".email-autocomplete").each(function(){$(this).autocomplete({appendTo:$("<div></div>").addClass("email-autocomplete-content").appendTo($(document.body)),source:function(t,e){var n=t.term,o=n.match(/([^@]*)@([\s\S]*)$/);if(!o||!o[1])return void e([]);var i=o[1],s=o[2]||"",r=[];$.each(a.MAIL_DOMAIN,function(t,e){s&&0!==e.indexOf(s)||r.push([i,"@",e].join(""))}),e(r)}})}),$(".company-autocomplete").each(function(){$(this).autocomplete({minLength:1,appendTo:$("<div></div>").addClass("company-autocomplete-content").appendTo($(document.body)),source:function(t,e){var n=$(this.element),o=t.term;$.ajax("/team/companyComplete",{data:{company:o},dataType:"json",success:function(t){n.val()===o&&e(t.items)}})}})}),$(".team-autocomplete").each(function(){$(this).autocomplete({minLength:0,appendTo:$("<div></div>").addClass("team-autocomplete-content").appendTo($(document.body)),source:function(t,e){var n=$(this.element).data("teamCompanyId")||"",o=$("#"+n).val();if(o){var i=$(this.element),a=t.term;$.ajax("/team/teamComplete",{data:{company:o,team:a},dataType:"json",success:function(t){i.val()===a&&e(t.items)}})}}}).focus(function(){$(this).autocomplete("search",$(this).val())})})}),$(function(){var t={follow:function(t){var e=this,n=$(t.target).closest(".user-card"),o=n.data("id"),i=n.data("hasFollowed")||!1;return imweb.ajax.post("/follow/follow",{data:{master:o,cancel:i}}).done(function(t){0===t.ret&&e.setFollowInfo(n,t.data)}),!1},loadFollowInfo:function(t){var e=this,n=t.data("id");imweb.ajax.post("/follow/masterFollowInfo",{data:{master:n}}).done(function(n){e.setFollowInfo(t,n.data)})},setFollowInfo:function(t,e){var n=e.hasFollowed?"取消关注":"关注";t.find(".user-card-follow-btn").html(n),t.find(".follower-count").html(e.masterFollowerCount),t.data("hasFollowed",e.hasFollowed)}},e=t;$(document).on("click",".user-card-follow-btn",_.bind(e.follow,e)),$(".user-card").each(function(){e.loadFollowInfo($(this))})}),$(function(){ui.attachDropdownLayer($("#nav-user-menu"),{layer:"#nav-user-menu-layer",offset:{top:50,left:84},enter:function(){$(this).closest(".user-sidebar-item").addClass("user-sidebar-item-active")},leave:function(){$(this).closest(".user-sidebar-item").removeClass("user-sidebar-item-active")}})}),$(function(){$(".not-sign").length&&window.Signin&&window.Signin.init(),$(".fancybox").length&&$(".fancybox").fancybox(),$("#topic_list").length&&$("#topic_list").lazyload({size:[200,120]}),ui.identicon(),window.Reprint&&window.Reprint.init()})},function(t,e){"use strict";t.exports={MAIL_DOMAIN:"qq.com;163.com;126.com;sohu.com;sina.com;gmail.com;21cn.com;hotmail.com;vip.qq.com;yeah.net".split(";"),regExps:{email:/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/,loginname:/^[\w]{5,20}$/,pass:/^[\w~`!@#$%\^&*()\-+=;:'",.<>\/?\\|\[\]{}]{6,20}$/,name:/^[\u4e00-\u9fa5]{2,5}$/,company:/^[\s\S]{1,50}$/,team:/^[\s\S]{0,50}$/},templateSettings:{evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g}}},function(t,e){"use strict";var n={};$(document).on("click",".ui-more-down",function(){$(this).removeClass("ui-more-down").addClass("ui-more-up")}),$(document).on("click",".ui-more-up",function(){$(this).removeClass("ui-more-up").addClass("ui-more-down")}),$(document).on("click",".ui-more-left",function(){$(this).removeClass("ui-more-left").addClass("ui-more-right")}),$(document).on("click",".ui-more-right",function(){$(this).removeClass("ui-more-right").addClass("ui-more-left")}),$(document).on("click",".ui-disabled",function(t){t.preventDefault(),t.stopPropagation()}),$(function(){$("select").each(function(){"string"==typeof $(this).attr("value")&&$(this).val($(this).attr("value"))})});var o=100;n.attachDropdownLayer=function(t,e){var n=$(e.layer);e.mode=e.mode||"click";var i=e.offset||{};i.top=i.top?+i.top.toString().replace("px",""):0,i.left=i.left?+i.left.toString().replace("px",""):0,e.enter=e.enter||$.noop,e.leave=e.leave||$.noop;var a=null,s=null,r=function(){s&&(clearTimeout(s),s=null),"none"!==n.css("display")||a||(a=setTimeout(u,o))},c=function(){a&&(clearTimeout(a),a=null),"none"===n.css("display")||s||(s=setTimeout(l,o))},u=function(){a=null;t.position();n.css("display","block"),n.css({left:i.left,top:i.top}),e.enter.apply(t[0])},l=function(){s=null,n.css("display","none"),e.leave.apply(t[0])};t.hover(r,c),n.hover(r,c)},n.Validator=function(t){this.input=t.input,this.$input=$(t.input),this.options=t;var e=this;this.$input.blur(function(){e.check()}).bind("keypress keydown keyup",function(){e._checkTimes&&e.check()}),(this.options.required||this.options.requiredTag)&&this.$input.closest(".control-group").addClass("required")},n.Validator.prototype={check:function(){this._checkTimes=this._checkTimes||0,this._checkTimes++;var t=this._check();return t?(this.error(t),!1):(this.succss(),!0)},_check:function(){this.options.trim!==!1&&this.$input.val($.trim(this.$input.val()));var t=this.$input.val();return this.options.required&&!t?this.options.requiredError:this.options.regexp&&!this.options.regexp.test(t)?this.options.regexpError:this.options.validate?this.options.validate(t):void 0},error:function(t){var e=this.$input.closest(".control-group");this._setErrorMsg(t),e.addClass("error")},succss:function(){var t=this.$input.closest(".control-group");this._setErrorMsg(""),t.removeClass("error")},_setErrorMsg:function(t){var e=this.$input.nextAll(".error-msg");e.length||(e=$("<span></span>").addClass("error-msg"),this.$input.after(e)),e.html(t)}},n.FormValidator=function(t,e){t.length&&(this.$form=t,this.validators=e,t.submit(function(){var t=!0;return $.each(e,function(e,n){n.check()||(t=!1)}),t}))},n.identicon=function(){for(var t=$("img.js-identicon"),e=0,n=t.length;e<n;e++){var o=t.eq(e).attr("src"),i=o.match(/avatar\/.+?\?size/);if(i&&i[0]){o=i[0],o=o.replace("avatar/","").replace("?size","");var a=new Identicon(o,420).toString();t.eq(e).attr("src","data:image/png;base64,"+a)}}},window.ui=n},function(t,e){"use strict";imweb.DraftAutoSave=Class(EventEmitter,{constructor:function(t){var e=3e3;this.options=t,this.draftId=t.draftId||null,this.topicId=t.topicId||null,this.input=this.options.input(),this._intervalId=setInterval(_.bind(this.autosave,this),t.interval||e)},autosave:function(){var t=this,e=t.options.input();e&&(t.input.tab===e.tab&&t.input.title===e.title&&t.input.content===e.content||!t.draftId&&t.input.content.length<30||t.save())},save:function(){var t=this,e=t.options.input();e&&imweb.ajax.post("/draft/autosave",{data:_.extend({draft_id:t.draftId,topic_id:t.topicId},e)}).done(function(n){if(0===n.ret){var o=_.extend({draftId:n.data.id,draftCount:n.count},e);t.input=e,t.draftId=n.data.id,t.topicId=n.data.topic_id||t.topicId,t.emit("saved",o)}})},showHint:function(){var t=$("#draft-autosave-hint");t.length||(t=$('<div id="draft-autosave-hint"></div>').appendTo(document.body)),t.css({display:"block",opacity:0}).animate({opacity:.7},500,function(){setTimeout(function(){t.animate({opacity:0},500,function(){t.css({display:"none"})})},1200)})},dispose:function(){this.removeEvent(),this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null)}})}]);